# Story 1.1: Contractor Domain Models

## Status
Approved

## Story

**As a** developer,
**I want** contractor domain entities and value objects defined,
**so that** I can implement contractor CRUD operations with proper business logic.

## Acceptance Criteria

1. **Contractor Entity:** Contractor aggregate root with all required properties (id, name, baseLocation, rating, workingHours, skills, calendar)
2. **Value Objects:** GeoLocation, WorkingHours, ContractorCalendar, CalendarException value objects
3. **Domain Validation:** Business rules enforced (rating 0-100, skills normalized, working hours valid)
4. **Domain Events:** Domain events defined (ContractorCreated, ContractorUpdated, ContractorRated)
5. **Repository Interface:** IContractorRepository interface defined in domain
6. **Aggregate Boundaries:** Proper aggregate boundaries maintained
7. **Immutable Value Objects:** Value objects are immutable
8. **Type Safety:** Strong typing for all domain concepts

## Tasks / Subtasks

- [ ] Create domain entities
  - [ ] Create `Contractor` aggregate root in `src/SmartScheduler.Domain/Contracts/`
  - [ ] Add properties: Id, Name, BaseLocation, Rating, WorkingHours, Skills, Calendar
  - [ ] Add computed properties: Availability, JobsToday, MaxJobsPerDay, CurrentUtilization, Timezone
- [ ] Create value objects
  - [ ] Create `GeoLocation` value object (latitude, longitude, address, city, state, postalCode, country, formattedAddress, placeId)
  - [ ] Create `WorkingHours` value object (dayOfWeek, startTime, endTime, timeZone)
  - [ ] Create `ContractorCalendar` value object (holidays, exceptions, dailyBreakMinutes)
  - [ ] Create `CalendarException` value object (date, type, workingHours)
- [ ] Implement domain validation
  - [ ] Rating must be 0-100 (defaults to 50)
  - [ ] Skills must be normalized (trimmed, lowercase)
  - [ ] Working hours must be valid (start < end, valid dayOfWeek 0-6)
  - [ ] Base location must have valid coordinates
- [ ] Define domain events
  - [ ] Create `ContractorCreated` event
  - [ ] Create `ContractorUpdated` event
  - [ ] Create `ContractorRated` event
- [ ] Create repository interface
  - [ ] Create `IContractorRepository` in domain layer
  - [ ] Define methods: GetById, GetAll, GetBySkills, Add, Update, Delete

## Dev Notes

### Relevant Source Tree Info
- Domain entities: `src/SmartScheduler.Domain/Contracts/Entities/`
- Value objects: `src/SmartScheduler.Domain/Contracts/ValueObjects/`
- Domain events: `src/SmartScheduler.Domain/Contracts/Events/`
- Repository interfaces: `src/SmartScheduler.Domain/Contracts/Repositories/`

### Architecture References
- **Data Models:** See `docs/architecture/data-models.md` for Contractor model specification
- **DDD Patterns:** Domain-Driven Design - see `docs/architecture/high-level-architecture.md`
- **TypeScript Interfaces:** Frontend expects TypeScript interfaces matching these models (will be generated via NSwag)

### Testing Standards
- **Test Location:** `src/SmartScheduler.Domain.Tests/`
- **Domain Tests:** Unit tests for domain logic, validation, and business rules
- **Test Scenarios:** Valid contractor creation, invalid rating, skill normalization, working hours validation

### UI Integration Notes
- Frontend already has `Contractor` interface defined (see `frontend/components/contractors/contractor-list.tsx`)
- Frontend uses mock data - will be replaced with API calls
- NSwag will generate TypeScript interfaces from backend DTOs to match frontend expectations

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-XX | 1.0 | Initial story created | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
_To be populated by dev agent_

### Debug Log References
_To be populated by dev agent_

### Completion Notes List
_To be populated by dev agent_

### File List
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_

