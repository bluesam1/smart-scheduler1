# Story 2.1: Job Domain Models

## Status
Approved

## Story

**As a** developer,
**I want** job domain entities and value objects defined,
**so that** I can implement job CRUD operations with proper business logic.

## Acceptance Criteria

1. **Job Entity:** Job aggregate root with all required properties (id, type, description, duration, location, timezone, requiredSkills, serviceWindow, priority, status)
2. **Value Objects:** TimeWindow, GeoLocation (enhanced with structured address)
3. **Domain Validation:** Business rules enforced (required skills, valid service window, priority levels)
4. **Domain Events:** Domain events defined (JobCreated, JobAssigned, JobRescheduled, JobCancelled)
5. **Repository Interface:** IJobRepository interface defined in domain
6. **Status Management:** Job status transitions properly managed
7. **Assignment Status:** Computed assignment status (Unassigned, Partially Assigned, Assigned)
8. **Timezone Support:** Timezone stored and used for time calculations

## Tasks / Subtasks

- [ ] Create domain entities
  - [ ] Create `Job` aggregate root in `src/SmartScheduler.Domain/Jobs/`
  - [ ] Add properties: Id, Type, Description, Duration, Location, Timezone, RequiredSkills, ServiceWindow, Priority, Status
  - [ ] Add computed properties: AssignmentStatus, AssignedContractors
- [ ] Create value objects
  - [ ] Use enhanced `GeoLocation` with structured address fields
  - [ ] Create `TimeWindow` value object (start, end)
  - [ ] Create `JobStatus` enum
  - [ ] Create `Priority` enum (Normal, High, Rush)
- [ ] Implement domain validation
  - [ ] Required skills must not be empty
  - [ ] Service window must be valid (start < end)
  - [ ] Duration must be positive
  - [ ] Location must have valid coordinates and address
- [ ] Define domain events
  - [ ] Create `JobCreated` event
  - [ ] Create `JobAssigned` event
  - [ ] Create `JobRescheduled` event
  - [ ] Create `JobCancelled` event
- [ ] Create repository interface
  - [ ] Create `IJobRepository` in domain layer
  - [ ] Define methods: GetById, GetAll, GetByStatus, GetByPriority, Add, Update

## Dev Notes

### Relevant Source Tree Info
- Domain entities: `src/SmartScheduler.Domain/Jobs/Entities/`
- Value objects: `src/SmartScheduler.Domain/Jobs/ValueObjects/`
- Domain events: `src/SmartScheduler.Domain/Jobs/Events/`
- Repository interfaces: `src/SmartScheduler.Domain/Jobs/Repositories/`

### Architecture References
- **Data Models:** See `docs/architecture/data-models.md` for Job model specification
- **Address Validation:** Google Places Autocomplete integration - see `docs/prd/epic-2-job-intake-attributes-windows.md`
- **Timezone:** Timezone lookup from coordinates - see architecture spec

### Testing Standards
- **Test Location:** `src/SmartScheduler.Domain.Tests/`
- **Domain Tests:** Unit tests for domain logic, validation, status transitions
- **Test Scenarios:** Valid job creation, invalid service window, status transitions, assignment status computation

### UI Integration Notes
- Frontend has `CreateJobDialog` component (see `frontend/components/jobs/create-job-dialog.tsx`)
- Frontend uses `AddressInput` component for address entry
- Frontend expects structured address data from Google Places API
- UI is 95% complete - needs API integration

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-XX | 1.0 | Initial story created | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
_To be populated by dev agent_

### Debug Log References
_To be populated by dev agent_

### Completion Notes List
_To be populated by dev agent_

### File List
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_

