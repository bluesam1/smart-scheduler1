# Story 0.4: Connect Frontend to Backend

## Status
Approved

## Story

**As a** developer,
**I want** the frontend to connect to the backend API with proper configuration,
**so that** the UI can make authenticated API calls and display real data.

## Acceptance Criteria

1. **API Client Generation:** NSwag generates TypeScript client from OpenAPI spec
2. **API Configuration:** Frontend configured with API base URL from environment
3. **Authentication Integration:** Frontend gets and includes JWT tokens in API requests
4. **Health Check:** Frontend can verify API availability
5. **Error Handling:** Frontend handles API errors gracefully
6. **Type Safety:** Generated TypeScript interfaces match frontend expectations
7. **CORS:** Backend CORS configured for frontend origin
8. **Environment Variables:** API URL configurable per environment
9. **API Client Factory:** Factory function creates API clients with auth
10. **Connection Testing:** Frontend can successfully connect to backend

## Tasks / Subtasks

- [ ] Configure NSwag
  - [ ] Create `nswag.json` configuration file
  - [ ] Configure interface-based model generation
  - [ ] Set output path to `frontend/lib/api/generated/api-client.ts`
- [ ] Generate API client
  - [ ] Run NSwag to generate TypeScript client
  - [ ] Verify interfaces match frontend expectations
  - [ ] Document generation workflow
- [ ] Create API client factory
  - [ ] Create `frontend/lib/api/api-client-config.ts`
  - [ ] Implement factory function with auth token injection
  - [ ] Configure base URL from environment
- [ ] Configure environment variables
  - [ ] Add `NEXT_PUBLIC_API_URL` to `.env.local`
  - [ ] Set default to `http://localhost:5004`
  - [ ] Document environment setup
- [ ] Implement authentication integration
  - [ ] Get JWT token from Cognito (or auth context)
  - [ ] Include token in API request headers
  - [ ] Handle token expiration
- [ ] Add health check integration
  - [ ] Create health check utility
  - [ ] Verify API availability on app load
- [ ] Configure CORS on backend
  - [ ] Allow frontend origin (`http://localhost:3000`)
  - [ ] Allow credentials for authenticated requests
- [ ] Add error handling utilities
  - [ ] Create error handling helpers
  - [ ] Standardize error display

## Dev Notes

### Relevant Source Tree Info
- API client: `frontend/lib/api/generated/api-client.ts` (generated)
- API config: `frontend/lib/api/api-client-config.ts`
- Environment: `frontend/.env.local`

### Architecture References
- **API Client Generation:** See `docs/architecture/api-client-generation.md` for NSwag configuration
- **API Specification:** See `docs/architecture/api-specification.md`
- **Frontend Structure:** Frontend at `frontend/` using Next.js 14+

### Testing Standards
- **Test Location:** `frontend/__tests__/`
- **API Client Tests:** Test client generation and factory function
- **Integration Tests:** Test API connection and authentication

### UI Integration Notes
- Frontend already structured for API integration
- Components expect API client to be available
- This story enables all subsequent UI-to-API connection stories

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-XX | 1.0 | Initial story created | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
_To be populated by dev agent_

### Debug Log References
_To be populated by dev agent_

### Completion Notes List
_To be populated by dev agent_

### File List
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_

