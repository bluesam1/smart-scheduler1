# Story 0.6: Database Migrations & Seed Data

## Status
Approved

## Story

**As a** developer,
**I want** database migrations and seed data configured,
**so that** I can set up and populate the database for development and testing.

## Acceptance Criteria

1. **Migration System:** EF Core migrations configured and working
2. **Initial Schema:** Initial database schema created via migration
3. **PostGIS Extension:** PostGIS extension enabled in database
4. **Seed Data:** Seed data script for development
5. **Migration Scripts:** Scripts to apply migrations in different environments
6. **Rollback Support:** Ability to rollback migrations
7. **Seed Data Management:** Seed data can be applied/cleared independently
8. **Documentation:** Migration and seeding process documented
9. **Test Data:** Test data seed script for integration tests
10. **Database Setup Guide:** Clear instructions for setting up database

## Tasks / Subtasks

- [ ] Configure EF Core migrations
  - [ ] Set up migration project or folder
  - [ ] Configure migration naming convention
- [ ] Create initial migration
  - [ ] Create migration for initial schema
  - [ ] Include PostGIS extension in migration
  - [ ] Verify migration SQL is correct
- [ ] Create seed data script
  - [ ] Create seed data for contractors
  - [ ] Create seed data for jobs
  - [ ] Create seed data for system configuration (job types, skills)
  - [ ] Make seed data idempotent
- [ ] Create migration scripts
  - [ ] Script to apply migrations (dev)
  - [ ] Script to apply migrations (production)
  - [ ] Script to rollback migrations
- [ ] Create test data seed
  - [ ] Create minimal test data for integration tests
  - [ ] Ensure test data is isolated
- [ ] Document database setup
  - [ ] Document PostgreSQL setup
  - [ ] Document PostGIS installation
  - [ ] Document migration process
  - [ ] Document seed data process

## Dev Notes

### Relevant Source Tree Info
- Migrations: `src/SmartScheduler.Infrastructure/Migrations/`
- Seed data: `src/SmartScheduler.Infrastructure/Data/Seeding/`
- DbContext: `src/SmartScheduler.Infrastructure/Data/SmartSchedulerDbContext.cs`

### Architecture References
- **Database:** PostgreSQL 15+ with PostGIS - see `docs/architecture/tech-stack.md`
- **EF Core:** Entity Framework Core 8.0 - see architecture spec
- **Data Models:** See `docs/architecture/data-models.md` for entity structure

### Testing Standards
- **Migration Tests:** Test migrations apply and rollback correctly
- **Seed Data Tests:** Test seed data is applied correctly
- **Integration Tests:** Use test database with test seed data

### UI Integration Notes
- Seed data should include sample contractors and jobs for UI testing
- Development environment should have realistic seed data
- Test environment should have minimal seed data

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-XX | 1.0 | Initial story created | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
_To be populated by dev agent_

### Debug Log References
_To be populated by dev agent_

### Completion Notes List
_To be populated by dev agent_

### File List
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_

