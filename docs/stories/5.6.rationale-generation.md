# Story 5.6: Rationale Generation

## Status
Approved

## Story

**As a** dispatcher,
**I want** a human-readable rationale for each recommendation,
**so that** I can quickly understand why a contractor was recommended.

## Acceptance Criteria

1. **Rationale Format:** Deterministic template-based rationale (≤200 chars)
2. **Template System:** Templates for different score scenarios
3. **Factor Highlighting:** Highlights key factors (availability, rating, distance)
4. **Consistency:** Same inputs produce same rationale
5. **Readability:** Human-readable and concise
6. **Included in Response:** Rationale included in recommendation response
7. **Performance:** Rationale generation doesn't impact performance
8. **Testing:** Comprehensive tests
9. **Documentation:** Rationale format documented
10. **Localization:** Support for future localization (optional)

## Tasks / Subtasks

- [ ] Design rationale templates
  - [ ] Create templates for different scenarios
  - [ ] Keep under 200 characters
  - [ ] Make human-readable
- [ ] Implement rationale generator
  - [ ] Create `IRationaleGenerator` interface
  - [ ] Implement template selection
  - [ ] Fill template with factor values
- [ ] Create template scenarios
  - [ ] High availability scenario
  - [ ] High rating scenario
  - [ ] Low distance scenario
  - [ ] Balanced scenario
- [ ] Generate rationale
  - [ ] Select appropriate template
  - [ ] Fill in factor values
  - [ ] Ensure ≤200 characters
- [ ] Add to recommendation
  - [ ] Include rationale in Recommendation DTO
  - [ ] Include in API response
- [ ] Add unit tests
  - [ ] Test rationale generation
  - [ ] Test template selection
  - [ ] Test character limit
  - [ ] Test deterministic behavior
- [ ] Document rationale format
  - [ ] Document templates
  - [ ] Document selection logic

## Dev Notes

### Relevant Source Tree Info
- Rationale generator: `src/SmartScheduler.Application/Recommendations/Services/RationaleGenerator.cs`
- Templates: `src/SmartScheduler.Application/Recommendations/Templates/`

### Architecture References
- **Rationale:** See `docs/architecture/data-models.md` for rationale field (≤200 chars)
- **Deterministic:** Same inputs produce same rationale - see PRD
- **Template-Based:** Template system for consistency - see architecture

### Testing Standards
- **Test Location:** `src/SmartScheduler.Application.Tests/`
- **Rationale Tests:** Test generation, templates, character limit, deterministic behavior

### UI Integration Notes
- Rationale displayed in recommendation cards
- Frontend shows rationale in UI
- UI components already exist
- UI is 95% complete - needs API integration

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-XX | 1.0 | Initial story created | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
_To be populated by dev agent_

### Debug Log References
_To be populated by dev agent_

### Completion Notes List
_To be populated by dev agent_

### File List
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_

