# Story 5.1: Scoring Weights Configuration

## Status
Approved

## Story

**As a** system administrator,
**I want** scoring weights to be configurable and versioned,
**so that** I can tune the recommendation algorithm without code changes.

## Acceptance Criteria

1. **Weight Configuration:** Weights stored in versioned configuration
2. **Configurable Factors:** Availability, rating, distance, rotation weights configurable
3. **Version Management:** Config versions tracked and auditable
4. **Default Weights:** Default weights provided
5. **Config Storage:** Configuration stored securely (SSM Parameter Store/AppConfig)
6. **Config Loading:** Configuration loaded at runtime
7. **Config Validation:** Weights validated on load
8. **Version Tracking:** Config version included in audit trail
9. **Rollback Support:** Ability to rollback to previous config version
10. **Documentation:** Weight configuration documented

## Tasks / Subtasks

- [ ] Design weight configuration structure
  - [ ] Define weight schema (JSON)
  - [ ] Define versioning scheme
  - [ ] Define default weights
- [ ] Create configuration model
  - [ ] Create `ScoringWeightsConfig` class
  - [ ] Include all weight factors
  - [ ] Include version number
- [ ] Implement config storage
  - [ ] Store in SSM Parameter Store or AppConfig
  - [ ] Support versioning
  - [ ] Secure storage
- [ ] Implement config loading
  - [ ] Load config at startup
  - [ ] Cache config in memory
  - [ ] Reload on change (optional)
- [ ] Add config validation
  - [ ] Validate weight ranges
  - [ ] Validate weight sum (if applicable)
  - [ ] Validate required fields
- [ ] Integrate with scoring
  - [ ] Use config in scoring algorithm
  - [ ] Include version in audit trail
- [ ] Add rollback support
  - [ ] Store config history
  - [ ] Support rollback to previous version
- [ ] Create default configuration
  - [ ] Define default weights
  - [ ] Initialize with defaults
- [ ] Document configuration
  - [ ] Document weight factors
  - [ ] Document versioning
  - [ ] Document rollback process

## Dev Notes

### Relevant Source Tree Info
- Config model: `src/SmartScheduler.Application/Recommendations/Configuration/ScoringWeightsConfig.cs`
- Config loader: `src/SmartScheduler.Infrastructure/Configuration/WeightsConfigLoader.cs`

### Architecture References
- **Weights Config:** See `docs/prd/c-scoring-tuning.md`
- **Config Storage:** SSM Parameter Store/AppConfig - see `docs/prd/c-weights-regional-settings-appconfigparameter-store.md`
- **Versioning:** Config version in audit trail - see architecture

### Testing Standards
- **Test Location:** `src/SmartScheduler.Application.Tests/`
- **Config Tests:** Test loading, validation, versioning
- **Integration Tests:** Test config usage in scoring

### UI Integration Notes
- Config managed via Admin console (Epic 9)
- Config version displayed in audit trail
- UI for config management in Epic 9

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-XX | 1.0 | Initial story created | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
_To be populated by dev agent_

### Debug Log References
_To be populated by dev agent_

### Completion Notes List
_To be populated by dev agent_

### File List
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_

